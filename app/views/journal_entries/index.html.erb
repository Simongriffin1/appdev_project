<h1 class="page-title">Your entries</h1>

<% if @filtered_topic %>
  <p class="muted">
    Showing entries tagged with
    <span class="badge"><%= @filtered_topic.name %></span>
    <%= link_to "Clear filter", journal_entries_path %>
  </p>
<% end %>

<div class="card">
  <% if @journal_entries.any? %>
    <ul class="entry-list">
      <% @journal_entries.each do |entry| %>
        <li class="entry-list__item">
          <div class="entry-meta">
            <%= (entry.received_at || entry.created_at).strftime("%b %-d, %Y at %-I:%M %p") %>
            <% if entry.prompt %>
              <% if entry.prompt.question_1.present? %>
                · Reply to: "<%= entry.prompt.question_1.truncate(50) %>"
              <% elsif entry.prompt.body.present? %>
                · Reply to: "<%= entry.prompt.body.truncate(50) %>"
              <% end %>
            <% end %>
            <% if entry.source == "email" %>
              <span style="color: #28a745;">· Email</span>
            <% end %>
          </div>

          <div class="entry-body">
            <%= entry.body.truncate(220) %>
          </div>

          <div class="btn-row" style="margin-top: 0.4rem;">
            <%= link_to "Open entry", journal_entry_path(entry), class: "btn btn-ghost" %>
          </div>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p class="muted">No entries yet. Start by answering a question on your dashboard.</p>
  <% end %>

  <div class="btn-row" style="margin-top: 1rem;">
    <%= link_to "Back to dashboard", dashboard_path, class: "btn btn-ghost" %>
  </div>
</div>
